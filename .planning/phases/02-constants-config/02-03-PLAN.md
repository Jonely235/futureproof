---
phase: 02-constants-config
type: execute
---

<objective>
Replace hardcoded values in service files with centralized constants.

Purpose: Update all service files to use AppColors, AppStrings, and FinanceConfig constants instead of hardcoded values, improving maintainability and consistency.
Output: Service files using centralized constants throughout.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./02-01-SUMMARY.md
./02-02-SUMMARY.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-constants-config/02-01-SUMMARY.md
@.planning/phases/02-constants-config/02-02-SUMMARY.md
@lib/config/app_colors.dart
@lib/config/app_strings.dart
@lib/config/finance_config.dart
@lib/services/database_service.dart
@lib/services/analytics_service.dart
@lib/services/backup_service.dart
@lib/services/finance_calculator.dart

**Tech stack available:** AppLogger utility, AppColors, AppStrings, FinanceConfig from previous plans
**Established patterns:** Singleton config classes, import aliases, service-specific loggers
**Constraining decisions:**
- Phase 1: Use AppLogger for all logging
- Phase 2 Plans 1-2: Use newly created AppColors and AppStrings
- No new features (refactoring only)
- Maintain backwards compatibility
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace hardcoded values in database_service.dart</name>
  <files>lib/services/database_service.dart</files>
  <action>Replace hardcoded values in database_service.dart with constants:

1. Add imports:
   ```dart
   import '../config/app_colors.dart';
   import '../config/app_strings.dart';
   ```

2. Search for hardcoded Color(0xFF______) values
3. Replace with appropriate AppColors constants

4. Search for hardcoded string literals that could use AppStrings:
   - Error messages
   - Log messages
   - Validation strings

5. Search for magic numbers that could use FinanceConfig:
   - Batch sizes
   - Limits
   - Thresholds

6. DO NOT change logic or structure - only replace hardcoded values

7. Use AppLogger.database for logging (already configured)</action>
  <verify>grep -c "Color(0xFF" lib/services/database_service.dart returns 0 (or only in comments)</verify>
  <done>database_service.dart uses AppColors, AppStrings, and FinanceConfig for all constants</done>
</task>

<task type="auto">
  <name>Task 2: Replace hardcoded values in analytics_service.dart</name>
  <files>lib/services/analytics_service.dart</files>
  <action>Replace hardcoded values in analytics_service.dart with constants:

1. Add imports:
   ```dart
   import '../config/app_colors.dart';
   import '../config/app_strings.dart';
   import '../config/finance_config.dart';
   ```

2. Search for hardcoded Color(0xFF______) values
3. Replace with appropriate AppColors constants

4. Search for magic numbers:
   - Analysis thresholds
   - Calculation factors
   - Default values

5. Map magic numbers to FinanceConfig constants:
   - If number matches a FinanceConfig value, use it
   - If not, consider adding to FinanceConfig if it's a business rule

6. DO NOT change logic - only replace hardcoded values

7. Use AppLogger.analytics for logging (already configured)</action>
  <verify>grep -c "Color(0xFF" lib/services/analytics_service.dart returns 0</verify>
  <done>analytics_service.dart uses centralized constants for all hardcoded values</done>
</task>

<task type="auto">
  <name>Task 3: Replace hardcoded values in backup_service.dart and finance_calculator.dart</name>
  <files>lib/services/backup_service.dart, lib/services/finance_calculator.dart</files>
  <action>Replace hardcoded values in remaining service files:

1. For lib/services/backup_service.dart:
   - Add imports for AppColors, AppStrings
   - Replace hardcoded Color() values
   - Replace hardcoded strings (error messages, etc.)
   - Use AppLogger.backup for logging

2. For lib/services/finance_calculator.dart:
   - Add import for FinanceConfig (if not already present)
   - Replace magic numbers with FinanceConfig constants
   - Example: bufferPercentage, anomalyThresholdHigh, etc.
   - Use AppLogger.services for logging

3. For both files:
   - DO NOT change logic or structure
   - Only replace hardcoded values with constants
   - Maintain all existing functionality

4. If a magic number doesn't match any existing constant:
   - Leave it as-is (don't add new constants in this plan)
   - Log with AppLogger for future reference</action>
  <verify>grep -r "Color(0xFF" lib/services/*.dart returns no results</verify>
  <done>All service files use centralized constants, Phase 2 complete</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] flutter run starts without errors
- [ ] grep -r "Color(0xFF" lib/services/*.dart returns no results
- [ ] All services import and use AppColors/AppStrings/FinanceConfig
- [ ] Service functionality preserved (no logic changes)
- [ ] AppLogger used throughout service layer
</verification>

<success_criteria>

- All hardcoded colors in services replaced with AppColors
- All hardcoded strings in services replaced with AppStrings (where applicable)
- All magic numbers in services replaced with FinanceConfig (where applicable)
- No functional changes to services
- Phase 2 (Constants & Config) complete
</success_criteria>

<output>
After completion, create `.planning/phases/02-constants-config/02-03-SUMMARY.md`:

# Phase 2 Plan 3: Service Constants Summary

**Replaced hardcoded values in service files with centralized constants**

## Accomplishments

- database_service.dart migrated to AppColors and AppStrings
- analytics_service.dart migrated to centralized constants
- backup_service.dart migrated to AppColors and AppStrings
- finance_calculator.dart migrated to FinanceConfig
- Phase 2 (Constants & Config) complete

## Files Created/Modified

- `lib/services/database_service.dart` - Replaced hardcoded colors and strings
- `lib/services/analytics_service.dart` - Replaced hardcoded values
- `lib/services/backup_service.dart` - Replaced hardcoded colors and strings
- `lib/services/finance_calculator.dart` - Replaced magic numbers with FinanceConfig

## Decisions Made

- Replaced all Color(0xFF______) with AppColors constants
- Replaced applicable string literals with AppStrings constants
- Replaced magic numbers with FinanceConfig constants
- Maintained service functionality (no logic changes)
- Left unknown magic numbers as-is for future analysis

## Issues Encountered

None

## Next Phase Readiness

âœ… **Phase 2 (Constants & Config) COMPLETE** - all hardcoded values extracted to centralized constants
- Ready for Phase 3 (Error Handling)
- AppColors, AppStrings, FinanceConfig available throughout codebase
- Improved maintainability and consistency achieved

---
*Phase: 02-constants-config*
*Plan: 03 (Final plan of phase)*
*Completed: [date]*

